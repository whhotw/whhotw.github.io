<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: React-native | wlog]]></title>
  <link href="http://whhotw.github.io/blog/categories/react-native/atom.xml" rel="self"/>
  <link href="http://whhotw.github.io/"/>
  <updated>2019-08-30T01:28:06+08:00</updated>
  <id>http://whhotw.github.io/</id>
  <author>
    <name><![CDATA[w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Upgrade React-Native Version.]]></title>
    <link href="http://whhotw.github.io/blog/2019/04/10/upgrade-react-native-version/"/>
    <updated>2019-04-10T23:34:34+08:00</updated>
    <id>http://whhotw.github.io/blog/2019/04/10/upgrade-react-native-version</id>
    <content type="html"><![CDATA[<pre><code>~ react-native-git-upgrade 0.59.3
git-upgrade info Check for updates
git-upgrade info Using yarn 1.10.1
git-upgrade info Read package.json files
git-upgrade info Check declared version
git-upgrade info Check matching versions
git-upgrade info Check React peer dependency
git-upgrade info Check that Git is installed
git-upgrade info Get information from NPM registry
git-upgrade info Upgrading to React Native 0.59.3, React 16.8.3
git-upgrade info Setup temporary working directory
git-upgrade info Configure Git environment
git-upgrade info Init Git repository
git-upgrade info Add all files to commit
git-upgrade info Commit current project sources
git-upgrade info Create a tag before updating sources
git-upgrade info Generate old version template
git-upgrade ERR! An error occurred during upgrade:
git-upgrade ERR! Error: Couldn't find preset "module:metro-react-native-babel-preset" relative to directory "/Users/whh/FUNBLOCK"
    at /Users/whh/.config/yarn/global/node_modules/babel-core/lib/transformation/file/options/option-manager.js:293:19
    at Array.map (&lt;anonymous&gt;)
    at OptionManager.resolvePresets (/Users/whh/.config/yarn/global/node_modules/babel-core/lib/transformation/file/options/option-manager.js:275:20)
    at OptionManager.mergePresets (/Users/whh/.config/yarn/global/node_modules/babel-core/lib/transformation/file/options/option-manager.js:264:10)
    at OptionManager.mergeOptions (/Users/whh/.config/yarn/global/node_modules/babel-core/lib/transformation/file/options/option-manager.js:249:14)
    at OptionManager.init (/Users/whh/.config/yarn/global/node_modules/babel-core/lib/transformation/file/options/option-manager.js:368:12)
    at compile (/Users/whh/.config/yarn/global/node_modules/babel-register/lib/node.js:103:45)
    at loader (/Users/whh/.config/yarn/global/node_modules/babel-register/lib/node.js:144:14)
    at Object.require.extensions.(anonymous function) [as .js] (/Users/whh/.config/yarn/global/node_modules/babel-register/lib/node.js:154:7)
    at Module.load (module.js:566:32)
git-upgrade ERR! Restore initial sources
</code></pre>

<p>因為 <code>.babelrc</code> 不符合預期，刪除檔案可以排除問題。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TextInput Cannot Blur on Press Back Button of Android]]></title>
    <link href="http://whhotw.github.io/blog/2018/08/10/textinput-cannot-blur-on-press-back-button-of-android/"/>
    <updated>2018-08-10T15:23:19+08:00</updated>
    <id>http://whhotw.github.io/blog/2018/08/10/textinput-cannot-blur-on-press-back-button-of-android</id>
    <content type="html"><![CDATA[<p>先說一下我是在 RN 0.51，搞不好新版本不會有這問題&hellip;</p>

<p>在 Android 平台上遇到的一個小小問題，需求是這樣的，畫面上有 4 個輸入框，我不希望使用者可以手動點擊要輸入的框框是哪一個，因此我鎖住 touch event (用一個 View 遮住)，然後透過 event 來取得 focus。</p>

<p>在 iOS 沒問題，行為都是我預期的那樣，使用者可以透過我準備的按鈕把鍵盤彈起，但在 Android 的時候，假如使用者按 Back Button 把鍵盤收起來（或是系統的行為。如：收到簡訊），就無法在彈起了&hellip;</p>

<p>這是為什麼呢？</p>

<p>就我實驗的結果發現，假如使用者不是自己按下鍵盤上的<a href="https://cdn.wccftech.com/wp-content/uploads/2016/12/Google-Gboard-Keyboard-app.jpg">完成</a>，讓鍵盤收起。<code>TextInput</code> 事實上並不會 <code>call blur()</code></p>

<p>什麼意思呢？</p>

<blockquote><p>簡單的說即是焦點並沒有消失，導致下次就算 <code>call focus()</code> 也並不會有 <code>state</code> 的改變</p></blockquote>

<p>為了解決這問題，我的方法是監聽鍵盤被收起的時候，手動 <code>blur()</code></p>

<pre><code>class AAA {
  componentDidMount() {
    this.keyboardDidHideListener = Keyboard.addListener('keyboardDidHide', this.keyboardDidHide);
  }

  componentWillUnmount() {
    this.keyboardDidHideListener.remove();
  }

  keyboardDidHide = () =&gt; {
    this.input.blur();
  };
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[No Bundle Url Present: When the React Packager Tab Is Closed]]></title>
    <link href="http://whhotw.github.io/blog/2018/07/27/no-bundle-url-present-when-the-react-packager-tab-is-closed/"/>
    <updated>2018-07-27T18:17:11+08:00</updated>
    <id>http://whhotw.github.io/blog/2018/07/27/no-bundle-url-present-when-the-react-packager-tab-is-closed</id>
    <content type="html"><![CDATA[<p>當 Info.plist 中設定成下圖時，可能會無法在 DEBUG 模式下正常執行</p>

<p><img src="/assets/Screen-Shot-2018-07-27.png" width="1080" height="1920"></p>

<p>解決辦法</p>

<pre><code>remove "Allow Arbitrary Loads in Web Content"
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React-native-webrtc Crash on Running Device]]></title>
    <link href="http://whhotw.github.io/blog/2018/05/24/react-native-webrtc-crash-on-running-device/"/>
    <updated>2018-05-24T16:05:35+08:00</updated>
    <id>http://whhotw.github.io/blog/2018/05/24/react-native-webrtc-crash-on-running-device</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/oney/react-native-webrtc">react-native-webrtc</a> 跑在安卓實機的時候一直閃退，找了好久終於找到解法</p>

<p><a href="https://github.com/oney/react-native-webrtc/issues/230">參考這個issues</a></p>

<p>proguard rule 裡面加入</p>

<pre><code>-keep class org.webrtc.** { *; }
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RN WebView of Android Release Build Load Local HTML]]></title>
    <link href="http://whhotw.github.io/blog/2018/04/16/rn-webview-of-android-release-build-load-local-html/"/>
    <updated>2018-04-16T11:52:04+08:00</updated>
    <id>http://whhotw.github.io/blog/2018/04/16/rn-webview-of-android-release-build-load-local-html</id>
    <content type="html"><![CDATA[<p><code>RN</code> 中的 WebView 可以使用 <code>require()</code> 讀取靜態的 HTML 檔案。但是安卓的 <code>release</code> 階段要用 <code>file:///android_asset/xxx</code> 的寫法，否則會無法正常執行</p>

<p>靜態檔案放在 android project 的 assets 底下</p>

<p><img src="/assets/ScreenShot2018-04-16at1157.png" width="1080" height="1920"></p>
]]></content>
  </entry>
  
</feed>
