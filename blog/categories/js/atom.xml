<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Js | wlog]]></title>
  <link href="http://whhotw.github.io/blog/categories/js/atom.xml" rel="self"/>
  <link href="http://whhotw.github.io/"/>
  <updated>2018-03-20T09:51:43+08:00</updated>
  <id>http://whhotw.github.io/</id>
  <author>
    <name><![CDATA[w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Fetch API Content-Type]]></title>
    <link href="http://whhotw.github.io/blog/2018/03/20/fetch-api-content-type/"/>
    <updated>2018-03-20T09:38:46+08:00</updated>
    <id>http://whhotw.github.io/blog/2018/03/20/fetch-api-content-type</id>
    <content type="html"><![CDATA[<p>最近用到 js 中的 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">fetch</a> 發現 <code>Content-Type</code> 會因為參數而改變</p>

<p>例如</p>

<pre><code>const options = {
  method,
  headers: {
    Accept: 'application/json',
    'Content-Type': 'application/json', // 指定
  },
  body: params, // 第二張圖
  // body: JSON.stringify(params), // 第一張圖
};

return fetch(url, options)
  .then((res) =&gt; {
    if (!res.ok) {
      throw new Error('請檢查網路連線');
    }

    return res.json();
  });
</code></pre>

<p>假如 <code>params</code> 沒有用 <code>JSON.stringify</code> 的話，實際傳出去的 <code>Content-Type</code> 不一定是 <code>application/json</code></p>

<p>我用 wireshark 做的實驗</p>

<p>{% /assets/Screen%20Shot%202018-03-20%20at%2009.44.png 1080 1920 %}</p>

<p>{% /assets/Screen%20Shot%202018-03-20%20at%2009.44.05.png 1080 1920 %}</p>
]]></content>
  </entry>
  
</feed>
